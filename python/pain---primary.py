# Professor George Peat, Professor Kelvin Jordan, James Bailey, Doctor Claire Burton, Doctor Victoria Welsh, Simon Wathall, Professor Jonathan Hill, Doctor Emma Parry, Doctor Dahai Yu, Steff Garvin, Michael Longeran, 2024.

import sys, csv, re

codes = [{"code":"102570003.0","system":"snomedct"},{"code":"279069000.0","system":"snomedct"},{"code":"18876004.0","system":"snomedct"},{"code":"208242007","system":"snomedct"},{"code":"36186002","system":"snomedct"},{"code":"161896000","system":"snomedct"},{"code":"30085007","system":"snomedct"},{"code":"105606008","system":"snomedct"},{"code":"450521003","system":"snomedct"},{"code":"9682006","system":"snomedct"},{"code":"82675004","system":"snomedct"},{"code":"58580000","system":"snomedct"},{"code":"281535004","system":"snomedct"},{"code":"788465007","system":"snomedct"},{"code":"263247007","system":"snomedct"},{"code":"267954009","system":"snomedct"},{"code":"281974002","system":"snomedct"},{"code":"6698000","system":"snomedct"},{"code":"74779009","system":"snomedct"},{"code":"281543009","system":"snomedct"},{"code":"202664003","system":"snomedct"},{"code":"417076003","system":"snomedct"},{"code":"30989003","system":"snomedct"},{"code":"263133002","system":"snomedct"},{"code":"202856007","system":"snomedct"},{"code":"202900007","system":"snomedct"},{"code":"1088071000000108","system":"snomedct"},{"code":"61007003","system":"snomedct"},{"code":"53226007","system":"snomedct"},{"code":"399269003","system":"snomedct"},{"code":"31978002","system":"snomedct"},{"code":"135897006","system":"snomedct"},{"code":"207959006","system":"snomedct"},{"code":"298494008","system":"snomedct"},{"code":"24424003","system":"snomedct"},{"code":"239872002","system":"snomedct"},{"code":"428257007","system":"snomedct"},{"code":"53057004","system":"snomedct"},{"code":"202031002","system":"snomedct"},{"code":"37895003","system":"snomedct"},{"code":"906591000006102","system":"snomedct"},{"code":"53286005","system":"snomedct"},{"code":"18347007","system":"snomedct"},{"code":"4046000","system":"snomedct"},{"code":"298857005","system":"snomedct"},{"code":"2089002","system":"snomedct"},{"code":"203534009","system":"snomedct"},{"code":"413428007","system":"snomedct"},{"code":"239867006","system":"snomedct"},{"code":"157266009","system":"snomedct"},{"code":"721291009","system":"snomedct"},{"code":"262520005","system":"snomedct"},{"code":"298382003","system":"snomedct"},{"code":"309567004","system":"snomedct"},{"code":"208444006","system":"snomedct"},{"code":"203095000","system":"snomedct"},{"code":"203082005","system":"snomedct"},{"code":"209557005","system":"snomedct"},{"code":"9808005","system":"snomedct"},{"code":"67801009","system":"snomedct"},{"code":"29210001","system":"snomedct"},{"code":"201837004","system":"snomedct"},{"code":"939761000006103","system":"snomedct"},{"code":"416209007","system":"snomedct"},{"code":"299060006","system":"snomedct"},{"code":"2764000","system":"snomedct"},{"code":"302941001","system":"snomedct"},{"code":"1539003","system":"snomedct"},{"code":"1003721002","system":"snomedct"},{"code":"162411004","system":"snomedct"},{"code":"203131005","system":"snomedct"},{"code":"712893003","system":"snomedct"},{"code":"311821002","system":"snomedct"},{"code":"202805003","system":"snomedct"},{"code":"75857000","system":"snomedct"},{"code":"81680005","system":"snomedct"},{"code":"77547008","system":"snomedct"},{"code":"432473000","system":"snomedct"},{"code":"208921000","system":"snomedct"},{"code":"209354002","system":"snomedct"},{"code":"263128001","system":"snomedct"},{"code":"387800004","system":"snomedct"},{"code":"74323005","system":"snomedct"},{"code":"55146009","system":"snomedct"},{"code":"161880003","system":"snomedct"},{"code":"279069000","system":"snomedct"},{"code":"125598003","system":"snomedct"},{"code":"208712008","system":"snomedct"},{"code":"88998003","system":"snomedct"},{"code":"311804006","system":"snomedct"},{"code":"414293001","system":"snomedct"},{"code":"239877008","system":"snomedct"},{"code":"269080004","system":"snomedct"},{"code":"208145002","system":"snomedct"},{"code":"443700006","system":"snomedct"},{"code":"80068009","system":"snomedct"},{"code":"448589005","system":"snomedct"},{"code":"30556007","system":"snomedct"},{"code":"309246000","system":"snomedct"},{"code":"240003004","system":"snomedct"},{"code":"281975001","system":"snomedct"},{"code":"240205003","system":"snomedct"},{"code":"11049006","system":"snomedct"},{"code":"68854005","system":"snomedct"},{"code":"239960007","system":"snomedct"},{"code":"18876004","system":"snomedct"},{"code":"262965006","system":"snomedct"},{"code":"8847002","system":"snomedct"},{"code":"267889007","system":"snomedct"},{"code":"202490009","system":"snomedct"},{"code":"271587009","system":"snomedct"},{"code":"209629006","system":"snomedct"},{"code":"23056005","system":"snomedct"},{"code":"263199001","system":"snomedct"},{"code":"209238002","system":"snomedct"},{"code":"12519004","system":"snomedct"},{"code":"445008009","system":"snomedct"},{"code":"73589001","system":"snomedct"},{"code":"789758005","system":"snomedct"},{"code":"76107001","system":"snomedct"},{"code":"269113006","system":"snomedct"},{"code":"235231000119100","system":"snomedct"},{"code":"267039000","system":"snomedct"},{"code":"281531008","system":"snomedct"},{"code":"17222009","system":"snomedct"},{"code":"699462004","system":"snomedct"},{"code":"24693007","system":"snomedct"},{"code":"203638000","system":"snomedct"},{"code":"57676002","system":"snomedct"},{"code":"157265008","system":"snomedct"},{"code":"202914007","system":"snomedct"},{"code":"43295006","system":"snomedct"},{"code":"81498004","system":"snomedct"},{"code":"202487003","system":"snomedct"},{"code":"161894002","system":"snomedct"},{"code":"240261009","system":"snomedct"},{"code":"207957008","system":"snomedct"},{"code":"125605004","system":"snomedct"},{"code":"65966004","system":"snomedct"},{"code":"23482006","system":"snomedct"},{"code":"771083005","system":"snomedct"},{"code":"418237007","system":"snomedct"},{"code":"870207009","system":"snomedct"},{"code":"16114001","system":"snomedct"},{"code":"69195002","system":"snomedct"},{"code":"81902001","system":"snomedct"},{"code":"17059001","system":"snomedct"},{"code":"208399001","system":"snomedct"},{"code":"202794004","system":"snomedct"},{"code":"37785001","system":"snomedct"},{"code":"45231001","system":"snomedct"},{"code":"35678005","system":"snomedct"},{"code":"22878006","system":"snomedct"},{"code":"447139008","system":"snomedct"},{"code":"40799003","system":"snomedct"},{"code":"267982002","system":"snomedct"},{"code":"262971000","system":"snomedct"},{"code":"928000","system":"snomedct"},{"code":"202863007","system":"snomedct"},{"code":"49388007","system":"snomedct"},{"code":"281792000","system":"snomedct"},{"code":"10601006","system":"snomedct"},{"code":"202843000","system":"snomedct"},{"code":"43422002","system":"snomedct"},{"code":"428883008","system":"snomedct"},{"code":"209436000","system":"snomedct"},{"code":"33308003","system":"snomedct"},{"code":"125596004","system":"snomedct"},{"code":"405817008","system":"snomedct"},{"code":"9468002","system":"snomedct"},{"code":"263130004","system":"snomedct"},{"code":"125607007","system":"snomedct"},{"code":"44465007","system":"snomedct"},{"code":"64455005","system":"snomedct"},{"code":"270476009","system":"snomedct"},{"code":"6858004","system":"snomedct"},{"code":"4106009","system":"snomedct"},{"code":"359532006","system":"snomedct"},{"code":"33173003","system":"snomedct"},{"code":"91037003","system":"snomedct"},{"code":"447395005","system":"snomedct"},{"code":"11654001","system":"snomedct"},{"code":"102556003","system":"snomedct"},{"code":"239878003","system":"snomedct"},{"code":"4308002","system":"snomedct"},{"code":"70704007","system":"snomedct"},{"code":"51037009","system":"snomedct"},{"code":"134407002","system":"snomedct"},{"code":"21351003","system":"snomedct"},{"code":"202942009","system":"snomedct"},{"code":"202472008","system":"snomedct"},{"code":"12676007","system":"snomedct"},{"code":"208393000","system":"snomedct"},{"code":"202708005","system":"snomedct"},{"code":"272014002","system":"snomedct"},{"code":"239868001","system":"snomedct"},{"code":"202480001","system":"snomedct"},{"code":"208401007","system":"snomedct"},{"code":"240203005","system":"snomedct"},{"code":"299037003","system":"snomedct"},{"code":"442085002","system":"snomedct"},{"code":"81576005","system":"snomedct"},{"code":"18171007","system":"snomedct"},{"code":"301813003","system":"snomedct"},{"code":"208710000","system":"snomedct"},{"code":"269111008","system":"snomedct"},{"code":"125603006","system":"snomedct"},{"code":"13695006","system":"snomedct"},{"code":"926335004","system":"snomedct"},{"code":"283858004","system":"snomedct"},{"code":"201819000","system":"snomedct"},{"code":"80756009","system":"snomedct"},{"code":"22193007","system":"snomedct"},{"code":"208325003","system":"snomedct"},{"code":"55260003","system":"snomedct"},{"code":"208240004","system":"snomedct"},{"code":"161891005","system":"snomedct"},{"code":"263051004","system":"snomedct"},{"code":"202482009","system":"snomedct"},{"code":"65260001","system":"snomedct"},{"code":"282766005","system":"snomedct"},{"code":"42636007","system":"snomedct"},{"code":"48532005","system":"snomedct"},{"code":"240631000000102","system":"snomedct"},{"code":"45613006","system":"snomedct"},{"code":"202606004","system":"snomedct"},{"code":"442520000","system":"snomedct"},{"code":"267109007","system":"snomedct"},{"code":"53208009","system":"snomedct"},{"code":"415692008","system":"snomedct"},{"code":"269062008","system":"snomedct"},{"code":"2733002","system":"snomedct"},{"code":"75591007","system":"snomedct"},{"code":"103014001","system":"snomedct"},{"code":"342070009","system":"snomedct"},{"code":"263021005","system":"snomedct"},{"code":"129179000","system":"snomedct"},{"code":"274142002","system":"snomedct"},{"code":"209574005","system":"snomedct"},{"code":"870206000","system":"snomedct"},{"code":"1126007","system":"snomedct"},{"code":"62629000","system":"snomedct"},{"code":"202246002","system":"snomedct"},{"code":"208687001","system":"snomedct"},{"code":"202888004","system":"snomedct"},{"code":"202732003","system":"snomedct"},{"code":"209565008","system":"snomedct"},{"code":"278860009","system":"snomedct"},{"code":"239865003","system":"snomedct"},{"code":"202683005","system":"snomedct"},{"code":"10085004","system":"snomedct"},{"code":"125606003","system":"snomedct"},{"code":"16250001000004107","system":"snomedct"},{"code":"53627009","system":"snomedct"},{"code":"208916003","system":"snomedct"},{"code":"208719004","system":"snomedct"},{"code":"49218002","system":"snomedct"},{"code":"443798008","system":"snomedct"},{"code":"248491001","system":"snomedct"},{"code":"34268009","system":"snomedct"},{"code":"448394006","system":"snomedct"},{"code":"22817005","system":"snomedct"},{"code":"203639008","system":"snomedct"},{"code":"202936005","system":"snomedct"},{"code":"58150001","system":"snomedct"},{"code":"12584003","system":"snomedct"},{"code":"72047008","system":"snomedct"},{"code":"425940002","system":"snomedct"},{"code":"202381003","system":"snomedct"},{"code":"208634001","system":"snomedct"},{"code":"263251009","system":"snomedct"},{"code":"118952005","system":"snomedct"},{"code":"162429009","system":"snomedct"},{"code":"279035001","system":"snomedct"},{"code":"285365001","system":"snomedct"},{"code":"21794005","system":"snomedct"},{"code":"203645000","system":"snomedct"},{"code":"202842005","system":"snomedct"},{"code":"202596000","system":"snomedct"},{"code":"202752002","system":"snomedct"},{"code":"39848009","system":"snomedct"},{"code":"6654000","system":"snomedct"},{"code":"25899002","system":"snomedct"},{"code":"78514002","system":"snomedct"},{"code":"42188001","system":"snomedct"},{"code":"208166005","system":"snomedct"},{"code":"312225001","system":"snomedct"},{"code":"127278005","system":"snomedct"},{"code":"448355005","system":"snomedct"},{"code":"125604000","system":"snomedct"},{"code":"202881005","system":"snomedct"},{"code":"125599006","system":"snomedct"},{"code":"279043006","system":"snomedct"},{"code":"31975004","system":"snomedct"},{"code":"84869007","system":"snomedct"},{"code":"42786005","system":"snomedct"},{"code":"398878007","system":"snomedct"},{"code":"271771009","system":"snomedct"},{"code":"279029001","system":"snomedct"},{"code":"123536004","system":"snomedct"},{"code":"263246003","system":"snomedct"},{"code":"263055008","system":"snomedct"},{"code":"55300003","system":"snomedct"},{"code":"247373008","system":"snomedct"},{"code":"240008008","system":"snomedct"},{"code":"26538006","system":"snomedct"},{"code":"239720000","system":"snomedct"},{"code":"52011008","system":"snomedct"},{"code":"417109008","system":"snomedct"},{"code":"240131006","system":"snomedct"},{"code":"417746004","system":"snomedct"},{"code":"1003722009","system":"snomedct"},{"code":"208294009","system":"snomedct"},{"code":"423849004","system":"snomedct"},{"code":"424648000","system":"snomedct"},{"code":"263244000","system":"snomedct"},{"code":"74814004","system":"snomedct"},{"code":"359820003","system":"snomedct"},{"code":"202757008","system":"snomedct"},{"code":"85551004","system":"snomedct"},{"code":"27182002","system":"snomedct"},{"code":"208388003","system":"snomedct"},{"code":"481000119104","system":"snomedct"},{"code":"449917004","system":"snomedct"},{"code":"371081002","system":"snomedct"},{"code":"125597008","system":"snomedct"},{"code":"202336002","system":"snomedct"},{"code":"270887007","system":"snomedct"},{"code":"282775007","system":"snomedct"},{"code":"221695002","system":"snomedct"},{"code":"203681002","system":"snomedct"},{"code":"310484009","system":"snomedct"},{"code":"80692000","system":"snomedct"},{"code":"429513001","system":"snomedct"},{"code":"45352006","system":"snomedct"},{"code":"272009001","system":"snomedct"},{"code":"250082003","system":"snomedct"},{"code":"442056008","system":"snomedct"},{"code":"125600009","system":"snomedct"},{"code":"417558002","system":"snomedct"},{"code":"297193007","system":"snomedct"},{"code":"416189003","system":"snomedct"},{"code":"86380000","system":"snomedct"},{"code":"278862001","system":"snomedct"},{"code":"45326000","system":"snomedct"},{"code":"387802007","system":"snomedct"},{"code":"70070008","system":"snomedct"},{"code":"30760008","system":"snomedct"},{"code":"314916002","system":"snomedct"},{"code":"202693003","system":"snomedct"},{"code":"413875004","system":"snomedct"},{"code":"90834002","system":"snomedct"},{"code":"57406009","system":"snomedct"},{"code":"297194001","system":"snomedct"},{"code":"247369005","system":"snomedct"},{"code":"262981001","system":"snomedct"},{"code":"202855006","system":"snomedct"},{"code":"274160002","system":"snomedct"},{"code":"267970006","system":"snomedct"},{"code":"263233008","system":"snomedct"},{"code":"164539000","system":"snomedct"},{"code":"111640008","system":"snomedct"},{"code":"83561009","system":"snomedct"},{"code":"209529003","system":"snomedct"},{"code":"263054007","system":"snomedct"},{"code":"274162005","system":"snomedct"},{"code":"36071006","system":"snomedct"},{"code":"282776008","system":"snomedct"},{"code":"20511007","system":"snomedct"},{"code":"122481008","system":"snomedct"},{"code":"274179004","system":"snomedct"},{"code":"239874001","system":"snomedct"},{"code":"23680005","system":"snomedct"},{"code":"202916009","system":"snomedct"},{"code":"34789001","system":"snomedct"},{"code":"64217002","system":"snomedct"},{"code":"277890004","system":"snomedct"},{"code":"285395009","system":"snomedct"},{"code":"208430000","system":"snomedct"},{"code":"41511005","system":"snomedct"},{"code":"302222008","system":"snomedct"},{"code":"239733006","system":"snomedct"},{"code":"300955002","system":"snomedct"},{"code":"82423001","system":"snomedct"},{"code":"269105005","system":"snomedct"},{"code":"417163006","system":"snomedct"},{"code":"442048005","system":"snomedct"},{"code":"239863005","system":"snomedct"},{"code":"68962001","system":"snomedct"},{"code":"76865005","system":"snomedct"},{"code":"699370008","system":"snomedct"},{"code":"297142003","system":"snomedct"},{"code":"102570003","system":"snomedct"},{"code":"399114005","system":"snomedct"},{"code":"27741009","system":"snomedct"},{"code":"17883008","system":"snomedct"},{"code":"637091000000105","system":"snomedct"},{"code":"269112001","system":"snomedct"},{"code":"279039007","system":"snomedct"},{"code":"7674000","system":"snomedct"},{"code":"279040009","system":"snomedct"},{"code":"404098005","system":"snomedct"},{"code":"58781003","system":"snomedct"},{"code":"250102002","system":"snomedct"},{"code":"202609006","system":"snomedct"},{"code":"3199001","system":"snomedct"},{"code":"202788007","system":"snomedct"},{"code":"279038004","system":"snomedct"},{"code":"21698002","system":"snomedct"},{"code":"5913000","system":"snomedct"},{"code":"125602001","system":"snomedct"},{"code":"82991003","system":"snomedct"},{"code":"48210000","system":"snomedct"},{"code":"68449006","system":"snomedct"},{"code":"239961006","system":"snomedct"},{"code":"202733008","system":"snomedct"},{"code":"202882003","system":"snomedct"},{"code":"239866002","system":"snomedct"},{"code":"111243002","system":"snomedct"},{"code":"19660004","system":"snomedct"},{"code":"208394006","system":"snomedct"},{"code":"428151000","system":"snomedct"},{"code":"1931871000006102","system":"snomedct"},{"code":"228158008","system":"snomedct"},{"code":"269083002","system":"snomedct"},{"code":"202849001","system":"snomedct"},{"code":"202841003","system":"snomedct"},{"code":"209520004","system":"snomedct"},{"code":"359817006","system":"snomedct"},{"code":"33192001","system":"snomedct"},{"code":"161882006","system":"snomedct"},{"code":"66308002","system":"snomedct"},{"code":"208450001","system":"snomedct"},{"code":"310483003","system":"snomedct"},{"code":"34840004","system":"snomedct"},{"code":"308153009","system":"snomedct"},{"code":"25415003","system":"snomedct"},{"code":"239880009","system":"snomedct"},{"code":"95854004","system":"snomedct"},{"code":"125601008","system":"snomedct"},{"code":"207940009","system":"snomedct"},{"code":"23406007","system":"snomedct"},{"code":"56608008","system":"snomedct"},{"code":"371598009","system":"snomedct"},{"code":"40144003","system":"snomedct"},{"code":"209532000","system":"snomedct"},{"code":"84445001","system":"snomedct"},{"code":"263225007","system":"snomedct"},{"code":"23382007","system":"snomedct"},{"code":"396275006","system":"snomedct"},{"code":"75308009","system":"snomedct"},{"code":"54556006","system":"snomedct"},{"code":"263084004","system":"snomedct"},{"code":"263058005","system":"snomedct"},{"code":"399346004","system":"snomedct"},{"code":"247366003","system":"snomedct"},{"code":"202479004","system":"snomedct"},{"code":"90460009","system":"snomedct"},{"code":"54888009","system":"snomedct"},{"code":"42818005","system":"snomedct"},{"code":"111222003","system":"snomedct"},{"code":"360450007","system":"snomedct"},{"code":"262992000","system":"snomedct"},{"code":"267981009","system":"snomedct"},{"code":"10380004","system":"snomedct"},{"code":"161892003","system":"snomedct"},{"code":"78435003","system":"snomedct"},{"code":"64298006","system":"snomedct"},{"code":"87778004","system":"snomedct"},{"code":"46866001","system":"snomedct"},{"code":"282026002","system":"snomedct"},{"code":"95414005","system":"snomedct"},{"code":"203601000","system":"snomedct"},{"code":"203045001","system":"snomedct"},{"code":"36427004","system":"snomedct"},{"code":"267949000","system":"snomedct"},{"code":"47933007","system":"snomedct"},{"code":"65358001","system":"snomedct"},{"code":"209812006","system":"snomedct"},{"code":"267953003","system":"snomedct"},{"code":"263129009","system":"snomedct"},{"code":"208165009","system":"snomedct"},{"code":"77493009","system":"snomedct"},{"code":"64665009","system":"snomedct"},{"code":"36924003","system":"snomedct"},{"code":"299331007","system":"snomedct"},{"code":"704213001","system":"snomedct"},{"code":"209409002","system":"snomedct"},{"code":"125594001","system":"snomedct"},{"code":"699062006","system":"snomedct"},{"code":"203509009","system":"snomedct"},{"code":"67315001","system":"snomedct"},{"code":"300954003","system":"snomedct"},{"code":"202735001","system":"snomedct"},{"code":"239873007","system":"snomedct"},{"code":"127279002","system":"snomedct"},{"code":"281598004","system":"snomedct"},{"code":"125608002","system":"snomedct"},{"code":"239732001","system":"snomedct"},{"code":"84017003","system":"snomedct"},{"code":"71620000","system":"snomedct"}];
REQUIRED_CODES = 1;
with open(sys.argv[1], 'r') as file_in, open('musculoskeletal-paininjury-in-adults-potential-cases.csv', 'w', newline='') as file_out:
    csv_reader = csv.DictReader(file_in)
    csv_writer = csv.DictWriter(file_out, csv_reader.fieldnames + ["pain---primary-identified"])
    csv_writer.writeheader();
    codes_identified = 0;
    for row in csv_reader:
        newRow = row.copy();
        for cell in row:
            # Iterate cell lists (e.g. codes)
            for item in re.findall(r'\(([^,]*)\,', row[cell]):
                if(item in list(map(lambda code: code['code'], codes))): codes_identified+=1;
                if(codes_identified>=REQUIRED_CODES):
                    newRow["pain---primary-identified"] = "CASE";
                    break;
            if(codes_identified>=REQUIRED_CODES): break;
        if(codes_identified<REQUIRED_CODES):
            newRow["pain---primary-identified"] = "UNK";
        codes_identified=0;
        csv_writer.writerow(newRow)
